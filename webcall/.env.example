# ===== FastAPI / App =====
APP_NAME=WebCall
APP_ENV=dev
API_PREFIX=/api/v1
PORT=8000
HOST=0.0.0.0

# ===== Security =====
## Security
# Сгенерируй: openssl rand -hex 48  (минимум 32 байта)
JWT_SECRET=
JWT_EXPIRES_MIN=60
# Обязательный секрет для регистрации (укажи любое сложное значение)
REGISTRATION_SECRET=

# ===== Database =====
# Пароль задаётся в POSTGRES_PASSWORD ниже
DATABASE_URL=postgresql+asyncpg://webcall:${POSTGRES_PASSWORD}@postgres:5432/webcall
POSTGRES_PASSWORD=

# ===== Redis =====
REDIS_URL=redis://redis:6379/0

# ===== CORS (JSON array) =====
CORS_ORIGINS=["https://call.bandjshoos.ru","http://localhost:8000"]

# ===== WebRTC ICE =====
# STUN
STUN_SERVERS=["stun:stun.l.google.com:19302"]

# TURN: теперь список из UDP и TCP
# ВАЖНО: пароль ниже ДОЛЖЕН совпадать с docker-compose (coturn --user)
TURN_URLS=["turn:turn.example.com:3478?transport=udp","turn:turn.example.com:3478?transport=tcp"]
TURN_REALM=turn.example.com
TURN_PUBLIC_IP=1.2.3.4  # внешний публичный IP VPS
TURN_USERNAME=webcall
TURN_PASSWORD=  # задай реальный и тот же в compose

# ================= Notes =================
# 1. JWT_SECRET / REGISTRATION_SECRET должны быть заданы перед запуском.
# 2. TURN_PUBLIC_IP обязателен если сервер за NAT.
# 3. Для production обязательно поменяй все пустые поля.

VAPID_PUBLIC_KEY=
VAPID_PRIVATE_KEY=
VAPID_SUBJECT=mailto:you@example.com

# ===== AI Summaries / Telegram =====
# Включение AI выжимок (чат / голос). При false ничего не собирается и не отправляется.
AI_SUMMARY_ENABLED=true
# Максимум сообщений (или строк транскрипта), которые будут учитываться при формировании выжимки.
AI_SUMMARY_MAX_MESSAGES=1000
AI_SUMMARY_MIN_CHARS=80
# Провайдер/модель для генерации итоговой выжимки. Префикс openai: означает использование OpenAI Chat Completions.
AI_MODEL_PROVIDER=openai:gpt-4o-mini
# Запасная модель (опционально) если основная недоступна.
AI_MODEL_FALLBACK=
# Ключ OpenAI (НЕ коммить). Оставь пустым если хочешь только эвристическую выжимку.
OPENAI_API_KEY=
# Telegram бот (опционально): если задать токен и chat id -- выжимки будут отправляться в телеграм.
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# ===== Voice Capture / ASR =====
# Включение захвата голоса и отправки Opus webm чанков.
VOICE_CAPTURE_ENABLED=true
# Длительность одного чанка MediaRecorder (мс). Должна совпадать с настройкой на клиенте.
VOICE_CHUNK_MAX_MS=5000
# Модель OpenAI Whisper для распознавания (если пусто, используется whisper-1). Если OPENAI_API_KEY пуст – транскрипция отключена.
VOICE_ASR_MODEL=whisper-1
# Лимит суммарного объёма аудио в МБ (сервер может отклонять избыточные данные – TODO).
VOICE_MAX_TOTAL_MB=30

# ===== Доп (опционально) =====
# RATE_LIMIT=100/60
# CALL_INVITES_BACKEND=memory